<!--
 * @Author: Tianzw
 * @Date: 2021-03-04 11:20:50
 * @LastEditors: Please set LastEditors
 * @LastEditTime: 2021-03-04 18:40:55
 * @Description:
-->

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [1. 傅立叶变换](#1-傅立叶变换)
- [2 短时傅立叶变换](#2-短时傅立叶变换)
- [3 小波变换](#3-小波变换)
- [4 连续小波变换深入讨论](#4-连续小波变换深入讨论)
- [5 傅立叶变换、短时傅立叶变换、连续小波变换基函数对比](#5-傅立叶变换-短时傅立叶变换-连续小波变换基函数对比)
- [6. 小波母函数](#6-小波母函数)

<!-- /code_chunk_output -->

# 1. 傅立叶变换
1. 序列和
&emsp;&emsp;有序列 $x = [x_1, x_2, ..., x_n]$，则序列的和 $s(x)$ 为
$$s(x) = \sum_{i=1}^{n}{x_i}$$
2. 加权序列和
&emsp;&emsp;有序列 $x = [x_1, x_2, \cdots, x_n]$，及对应的**权重序列(基函数)** $w = [w_1, w_2,\cdots,w_n]$，则序列 $x$ 关于权重序列 $w$ 的加权和 $s(x, w)$
$$
s(x, w) = \sum_{i = 1}^{n}{w_i \cdot x_i}
$$
3. 傅立叶变换
傅立叶变换的一般形式
$$
\text{FT}(x, k) =\int_{-\infty}^{\infty}{x(t)e^{-jkt}dt} = \int_{-\infty}^{\infty}{x(t)cos(kt)dt} - j \cdot \int_{-\infty}^{\infty}x(t)sin(kt)dt
$$

其中，$k$ 为频率，$x(t)$ 为时间序列。

如果只考虑实部：
$$
s(X_t, W_t(k)) =\int_{-\infty}^{\infty}{x(t) \cdot cos(kt) dt}
$$


------

傅立叶变换本质是：时间序列 $X_t$，关于权重序列 $W_t(k) = cos(wt) - j \cdot sin(wt)$ 的加权和。

------

4. 相似性 VS 频率响应

&emsp;&emsp;令 $K = 50$，设原序列 $X_t(K) = sin(50t)$，序列集 $W = \{sin(kt) \mid 0 < k < 100\}$，序列 $X(K)$ 关于序列集 $W$ 的响应(或相似性为)：

$$
s(X(50), w(k)) =\int sin(50t) \cdot sin(kt) dt
$$

原序列 $X$ 关于序列集 $W$ 的响应图如下：
![响应图](../data/fig/responses.png)

------

现象：在序列集 $W$ 中，只有 $w(50)$ 和 $X(K)$ 的响应不为零，其余趋向于零。
推论：当 $k \to K$ 时，响应(或相似性) $s \neq 0$，否则 $s \to 0$
应用：**频率搜索**，即用一个时间序列集 $W$ 暴力搜索时间序列 $X$ 的频率

------

**TIPS**：理想的傅立叶变换，除了在 $w = 50 \;rad/s$ 处的积分值为非零常数，其余任意频率处的值都是零。


5. 直观理解：傅立叶变换，其实是在计算时域信号 $X(t)$ 在频率空间 $W$ 的响应(或相似性)

# 2 短时傅立叶变换
1.傅立叶变换的缺陷

-------

**只有全局信息，没有局部信息**；等价地说，只有频域信息，没有时域信息。

-------
比如：

$$
w1 =
\begin{cases}
    sin(5t) & \text{if}\quad 0 < t \leq 100\\
    sin(15t)    & \text{if}\quad 100 < t \leq 200
\end{cases}
$$

$$
w2 =
\begin{cases}
    sin(15t) & \text{if}\quad 0 < t \leq 100\\
    sin(5t)    & \text{if}\quad 100 < t \leq 200
\end{cases}
$$
时序信号 $w1,w2$ 的傅立叶变换完全一样。

------

**短时傅立叶变换的来源**：

&emsp;&emsp;为区别这两个时序信号，直观的想法是 **时域分窗** ：即将时域 $[0, 200)$ 分成两个时域窗口 $[0, 100)$ 和 $[100, 200)$，分别在这两个时域上作傅立叶变换。

------

&emsp;&emsp;我们将视角，放置在某个局部的时间窗口 $[t_1, t_2]$ 上，对时序信号 $x$ 进行傅立叶变换，即得到信号 $x$ 在时间窗口 $[t_1, t_2]$ 内的频域响应。
&emsp;&emsp;这本质是一种采样手段，只在指定的时间窗口内采样，窗口以外的权重为零。

# 3 小波变换
1. 时域分窗的局限

------

**<center>时域窗口可以无限小吗？</center>**

------

&emsp;&emsp;低频信号限制了时域窗口尺寸的下限：对于低频信号，其在一个较窄的时间窗口内，不能完整地观察到一个周期的数据，这时候的采样数据容易失真。

2. 鱼和熊掌不可兼得
    + 想要获得高清的时域信号，需要窗口足够小
    + 想要获得高清的频域信号，需要时间窗口足够大
    + 结论：高清的时域信号和高清的频域信号是不能同时拥有的

3. 窗口尺寸如何选择：
    + 固定，人工指定？
    + 灵活，交给算法自动选择？

------

**聪明的窗口**：该宽的时候宽，获得高清的频域信号，放弃时域分辨率；
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;该窄的时候窄，获得高清的时域信号，放弃频域分辨率。

------

4. **小波变换就是这个聪明的窗口**

# 4 连续小波变换深入讨论

&emsp;&emsp;为实现动态分辨率，引入小波母函数。小波母函数是一种函数的集合，满足了一定条件的函数均可以作为小波母函数，这个条件包含 4 部分：

1. 紧支撑性

&emsp;&emsp;只在一小部分定义域内不为零，其余部分均为零。
$$
\exist a > 0, \forall |t| > a,\psi(t) = 0
$$

**具有紧支撑性的函数，在原信号的时间轴上平移，相当于对原始信号进行加窗操作。**

2. 波动性

&emsp;&emsp;在定义域内的积分值为零，

$$
\int_{-\infty}^{\infty} \psi(t) dt = 0
$$

这说明小波母函数是一个波。

3. 容许条件

$$
c_{\psi} =2 \pi \int_{-\infty}^{\infty} {\tilde{\psi}(f) \over {|f|}}df < +\infty
$$

这个条件使**变换可逆**。其中，$\tilde{\psi}$ 是小波函数傅立叶变换的共轭。

4. 正交性

&emsp;&emsp;这个条件也是为了使变换可逆，证明从略。



5. 小波基函数举例：
![小波基函数](../data/fig/小波基.png)

&emsp;&emsp;可以看到，它具有紧支撑性(只在一小部分定义域里不为零，剩下部分均为零)，波动性(定义域内积分为零)

&emsp;&emsp;将小波母函数作为基函数(即权重序列)，与采集到的信号相乘并积分，可以筛选出：**信号在小波母函数非零部分(即视野内)，频率与小波母函数相近的成分。**

&emsp;&emsp;说明：傅立叶变换的基函数是单一固定频率的三角函数 $sin(kt),cos(kt), (k \in R)$，而小波母函数不具有特定的某一频率，而是具有一个范围内的频率。因此，**小波母函数筛选的是一定范围内的频率，类似于一个带通滤波**器。

6. 小波母函数的变换

$$
\psi^{*}(\tau,) = {1 \over {\sqrt{s}}} \psi(\cdot - \tau)
$$

+ **$\tau$ 控制平移**，$\tau$改变，相当于 $\psi(\tau)$ 在时间轴上不断地平移。
+ **$s$ 控制缩放**

变换公式前的${1 \over {\sqrt{s}}}$ 只是为了能量守恒，没有特别目的。

变换后的函数 $\psi^{*}(\tau,)$ 称为小波函数。

7. 多个尺度的小波基函数

![多尺度小波基函数](../data/fig/三个小波基函数.png)

+ 中间的图，$s$ 较小，相当于挤压，用以提高频率，降低宽度。 **高频，窄窗，高频率分辨率，低时间分辨率**
+ 右侧的图，$s$ 较大，相当于拉伸，用于降低频率，增加宽度。**低频，宽窗，高时间分辨率，低频率分辨率**

------

**<center>这就是：聪明的窗口</center>**

------

直观理解：$s$ 和 $f$(频率)是倒数关系

8. 连续小波变换举例
8.1 第一轮连续小波变换

&emsp;&emsp;黄色部分为信号，蓝色部分为小波基函数。

![连续小波变换](../data/fig/连续小波变换1.jpg)

&emsp;&emsp;如上图，用较小的 $s$ 对小波母函数进行缩放，此时小波函数频率较高，窗子较窄，用于筛选高频部分。
&emsp;&emsp;小波函数在时间轴上**平移**，每一次平移就对信号**采样加权求和**(在指定窗口内，与信号先相乘，再积分)，筛选出信号中与小波函数相近的部分。
&emsp;&emsp;此时，小波函数窗子较窄，频率较高，时间分辨率较高，频率分辨率较低。

8.2 第二轮连续小波变换

&emsp;&emsp;增大 $s$，对小波母函数进行缩放，此时小波函数频率降低，窗子变宽，用来筛选中频部分。小波函数在时间轴上**平移**，对信号执行 **采样加权求和** 操作。

![连续小波变换](../data/fig/连续小波变换2.jpg)

&emsp;&emsp;此时，窗子变宽，频率分辨率变高，时间分辨率变低。

8.3 第三轮连续小波变换，继续增大 $s$
![连续小波变换](../data/fig/连续小波变换3.jpg)
8.4 第 $n$ 轮连续小波变换，继续增大 $s$

8.5 连续小波变换公式

$$
CWT_{x}^{\psi}(\tau,s) = {1 \over \sqrt{s}}\int_{-\infty}^{+\infty} x(t) \psi({t \over s} - \tau) dt
$$

给定 $x, \psi$，二维扫描 $\{\tau, s \mid \tau \geq 0, s \in R^{+} \} $，获得信号的时域和频域响应。

# 5 傅立叶变换、短时傅立叶变换、连续小波变换基函数对比
![不同的基函数对比](../data/fig/基函数对比.jpg)

1. 傅立叶变换基函数
+ 定义域为 $(-\infty, +\infty)$ 的三角函数
+ 不具有紧支撑性，只能筛选频率，完全丧失时间信息，不具有时间分辨率。
2. 短时傅立叶变换
+ 用窗函数截断(图中是被高斯窗截断的)的三角函数
+ 具有紧支撑性，时域平移等同于分窗，使得短时傅立叶变换即能筛选频率，也能筛选时间。
+ 基函数先确定频率，再于窗函数相乘构成。因此不同的频率，具有同样的时间和频率分辨率。
+ 窗函数的长短难以确定
3. 连续小波变换
+ 是小波函数，具有紧支撑性
+ 时域平移等同于分窗，使得连续小波变换即能筛选频率，也能筛选时间。
+ 小波变换在改变频率的时候，是通过 **“缩放”** 实现的，这使得小波函数在改变频率的同时，也改变了窗长。因此不同的频率，具有不同的时间和频率分辨率，实现了分辨率动态可调。

# 6. 小波母函数
&emsp;&emsp;小波母函数有很多类型，比如 harr 小波，db系列小波，sym系列小波，coif 系列小波等等，这些小波的细节和使用场景从略。


------------------

参考：[从傅立叶变换进阶到小波变换](https://zhuanlan.zhihu.com/p/68323379)
